
Cloudinary Migration Notes (Client Account)
Date: Feb 2026

Goal
- Move admin image uploads from the old Cloudinary account (hard-coded cloud name) to the clientâ€™s new Cloudinary account.
- Keep uploads working without exposing Cloudinary API secrets in the frontend.
- Add basic protection against large/non-image uploads (2MB max) because Cloudinary-side restrictions were not available in the dashboard UI.
- Store uploads inside a specific folder: dplushchoice/products


1) What we found (before)
Cloudinary was hard-coded in the admin UI.

Where
- admin/src/pages/NewProduct.jsx
- admin/src/pages/Product.jsx
- admin/src/pages/Banners.jsx

What was hard-coded
- Upload URL (old cloud name):
	https://api.cloudinary.com/v1_1/<cloud_name>/image/upload
- Upload preset:
	upload_preset = "uploads"


2) What we changed (account migration)
We replaced the hard-coded Cloudinary URL with an env-based URL.

How it works now
- Upload URL is built like:
	https://api.cloudinary.com/v1_1/<cloud_name>/image/upload
- cloud_name comes from Vite env var:
	VITE_CLOUDINARY_CLOUD_NAME
- upload preset comes from Vite env var:
	VITE_CLOUDINARY_UPLOAD_PRESET

Client cloud name
- dwzdlml8c

Why we do NOT use API key/secret in admin
- The admin app is frontend code, so anything in it is visible to users.
- With unsigned uploads, the frontend only needs cloud_name + preset name.
- Cloudinary API secret must never be placed in frontend code.


3) Force uploads into a project folder
We added a Cloudinary "folder" value into the upload FormData.

How it works now
- Each upload sends:
	folder = VITE_CLOUDINARY_FOLDER
- Default folder:
	dplushchoice/products

Why
- Keeps the client Cloudinary account organized specifically for this project.


4) Added client-side validation (2MB)
Since preset restrictions were not visible in the Cloudinary UI, we enforced minimum checks in the admin UI before uploading.

Validation rules
- Max size: 2MB
- Allowed types: JPG/JPEG, PNG, WEBP, AVIF
	(MIME types: image/jpeg, image/png, image/webp, image/avif)

Behavior
- If invalid: show a toast error, clear the selected file, and stop the upload.


5) Env + config files
Added
- admin/.env.example
	VITE_CLOUDINARY_CLOUD_NAME=
	VITE_CLOUDINARY_UPLOAD_PRESET=
	VITE_CLOUDINARY_FOLDER=

Updated
- admin/.gitignore
	- ignores .env and .env.*


6) Files updated (admin)
- admin/src/pages/NewProduct.jsx
	- Uses env vars for cloud name/preset
	- Adds folder to uploads
	- Adds 2MB + image-type validation
- admin/src/pages/Product.jsx
	- Uses env vars for cloud name/preset
	- Adds folder to uploads
	- Adds 2MB + image-type validation
- admin/src/pages/Banners.jsx
	- Uses env vars for cloud name/preset
	- Adds folder to uploads
	- Adds 2MB + image-type validation


How to configure (admin)
1) In Cloudinary (client account): create an UNSIGNED upload preset named "uploads".
2) Create admin/.env from admin/.env.example (do not commit it).
3) Run admin:
	cd admin
	npm install
	npm run dev
