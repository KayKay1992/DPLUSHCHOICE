
REAL ADMIN ORDERS (ADMIN PANEL)
==============================

Goal
----
Replace the admin Orders page dummy data with real orders from the backend, and allow the admin to update order delivery status directly from the table.


1) Backend API used by Admin
----------------------------
The admin app calls the existing Orders API:

- GET  /api/V1/orders
	- Returns an array of orders.
	- The admin UI expects fields like:
		- _id
		- name
		- email
		- products: [{ productId, quantity, ... }]
		- total
		- status (0 = pending, 1 = delivered)
		- createdAt

- PUT /api/V1/orders/:id
	- Body: { status: 0 | 1 }
	- Updates a single order status.
	- The admin UI uses the response to update the row immediately.


2) CORS + Cookies (important)
-----------------------------
The admin app runs on a different origin (Vite dev server), so the backend must allow it.

Changes made:
- Backend CORS allowlist updated to include:
	- http://localhost:5175 (admin)
	- http://localhost:5173 / http://localhost:5174 (other frontends)
	- http://localhost:3000
- credentials: true is enabled in CORS so cookies are allowed.
- Added a global OPTIONS preflight handler using a RegExp matcher (Express 5):
	- app.options(/.*/, cors(...))
	This avoids the Express 5 error that happens with app.options("*", ...).

Cookie fix (local dev):
- Backend/utils/generateToken.js now sets:
	- secure = true only in production
	- sameSite = 'lax' in development
This prevents the auth cookie from being blocked when using http://localhost during development.


3) Admin Orders UI implementation
---------------------------------
File:
- admin/src/pages/Orders.jsx

What it does:
- Fetches real orders on page load:
	- userRequest.get("/orders")
- Displays the result in MUI DataGrid.
- Computes “Items” as the sum of quantities from order.products.
- Formats money (NGN) and createdAt date/time for display.

Actions:
- Each row has an action button:
	- If status is Pending (0): button marks Delivered (1)
	- If status is Delivered (1): button marks Pending (0)
- Update flow:
	1) userRequest.put(`/orders/${orderId}`, { status: nextStatus })
	2) Optimistically updates the row in React state
	3) Shows success/error toast
- A small “updatingOrderId” state disables the action button while a request is in flight.

Notifications:
- Admin uses react-toastify.
- ToastContainer is mounted once in admin/src/App.jsx so pages can call toast.success/toast.error.


4) “OrdersReal.jsx” cleanup
----------------------------
During development, a separate OrdersReal.jsx was created while the original Orders.jsx was corrupted.
Final outcome:
- Orders.jsx is the maintained page and contains the full real implementation.
- OrdersReal.jsx is now deprecated and only kept temporarily (safe to delete once confirmed unused).


5) Quick verification checklist
-------------------------------
- Start backend on port 8000.
- Start admin on http://localhost:5175.
- Open Admin → Orders:
	- Orders load without CORS errors
	- Table shows real DB orders
	- Clicking the action button toggles status and persists after refresh

